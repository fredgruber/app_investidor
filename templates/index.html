<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador DCA Bitcoin vs Tradicional</title>
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>Simulador de Investimentos DCA</h1>
            <div class="subtitle">Compare a estrat√©gia Dollar-Cost Averaging em Bitcoin contra Lump Sum em Ouro e S&P
                500</div>
        </header>

        <section class="card">
            <form action="/simulate" method="POST">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="amount">Valor por Per√≠odo (USD)</label>
                        <input type="number" id="amount" name="amount" value="{{.Amount}}" min="10" required>
                    </div>

                    <div class="form-group">
                        <label for="frequency">Frequ√™ncia</label>
                        <select id="frequency" name="frequency">
                            <option value="daily" {{if eq .Frequency "daily" }}selected{{end}}>Di√°rio</option>
                            <option value="weekly" {{if eq .Frequency "weekly" }}selected{{end}}>Semanal</option>
                            <option value="monthly" {{if eq .Frequency "monthly" }}selected{{end}}>Mensal</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="startDate">Data de In√≠cio</label>
                        <input type="date" id="startDate" name="startDate" value="{{.StartDate}}" required>
                    </div>
                    <div class="form-group">
                        <label for="endDate">Data Final</label>
                        <input type="date" id="endDate" name="endDate" value="{{.EndDate}}" required>
                    </div>
                </div>

                <div class="assets-section">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <h3>Sele√ß√£o de Ativos</h3>
                        <div class="selection-controls">
                            <button type="button" onclick="toggleColumn('dca_assets', true)" class="btn-small">Todos
                                DCA</button>
                            <button type="button" onclick="toggleColumn('ls_assets', true)" class="btn-small">Todos
                                LS</button>
                            <button type="button" onclick="clearAll()" class="btn-small outline">Limpar Tudo</button>
                        </div>
                    </div>

                    <div class="assets-table-container">
                        <table class="assets-selection-table">
                            <thead>
                                <tr>
                                    <th>Ativo</th>
                                    <th class="text-center" title="Comprar recorrente">DCA</th>
                                    <th class="text-center" title="Investimento √∫nico inicial">Lump Sum</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{range .Assets}}
                                <tr>
                                    <td>
                                        <span class="asset-name-row">{{.Name}}</span>
                                        <span class="asset-cat">{{.Category}}</span>
                                    </td>
                                    <td class="text-center">
                                        <label class="switch">
                                            <input type="checkbox" name="dca_assets" value="{{.Symbol}}" {{if index
                                                $.SelectedDCA .Symbol}}checked{{end}}>
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="text-center">
                                        <label class="switch">
                                            <input type="checkbox" name="ls_assets" value="{{.Symbol}}" {{if index
                                                $.SelectedLS .Symbol}}checked{{end}}>
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                </tr>
                                {{end}}
                                <!-- Linha Personalizada -->
                                <tr style="background: rgba(255, 255, 255, 0.05); border-top: 2px solid #30363d;">
                                    <td>
                                        <label for="custom_ticker"
                                            style="display:block; font-size: 0.8em; color: #8b949e; margin-bottom: 2px;">Outro
                                            Ativo (ex: WEGE3.SA)</label>
                                        <input type="text" id="custom_ticker" name="custom_ticker"
                                            value="{{.CustomTicker}}" placeholder="Ticker (Yahoo)"
                                            style="width: 100%; padding: 5px;">
                                    </td>
                                    <td class="text-center">
                                        <label class="switch">
                                            <input type="checkbox" name="custom_dca" {{if .CustomDCA}}checked{{end}}>
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                    <td class="text-center">
                                        <label class="switch">
                                            <input type="checkbox" name="custom_ls" {{if .CustomLS}}checked{{end}}>
                                            <span class="slider round"></span>
                                        </label>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <button type="submit" style="margin-top: 1.5rem;">Simular Compara√ß√£o</button>
            </form>
        </section>

        {{if .Error}}
        <div class="card" style="border-color: #ea3943;">
            <p style="color: #ea3943;">{{.Error}}</p>
        </div>
        {{end}}

        {{if .Results}}
        <section class="card">
            <h2>Resultados</h2>
            <table>
                <thead>
                    <tr>
                        <th>Estrat√©gia</th>
                        <th>Total Investido</th>
                        <th>Valor Final</th>
                        <th>Retorno %</th>
                        <th>Vantagem vs DCA</th>
                    </tr>
                </thead>
                <tbody>
                    {{range .Results}}
                    <tr>
                        <td>{{.StrategyName}}</td>
                        <td>${{printf "%.2f" .TotalInvested}}</td>
                        <td>${{printf "%.2f" .FinalValue}}</td>
                        <td class="{{if ge .ReturnPercent 0.0}}positive{{else}}negative{{end}}">{{printf "%.2f"
                            .ReturnPercent}}%</td>
                        <td>
                            <!-- Vantagem visual calculada no backend no futuro? -->
                        </td>
                    </tr>
                    {{end}}
                </tbody>
            </table>

            <div class="best-strategy">
                üèÜ Melhor Estrat√©gia: {{.BestStrategy}}
            </div>
        </section>

        <section class="insights">
            <div class="insight-card">
                <h3>üí° Por que DCA?</h3>
                <p>O Dollar-Cost Averaging (DCA) suaviza a entrada no mercado. Ao comprar quantias fixas regularmente,
                    voc√™ compra mais Bitcoin quando o pre√ßo cai e menos quando sobe, reduzindo o pre√ßo m√©dio por moeda e
                    eliminando o estresse de tentar acertar o "fundo" do mercado (timing).</p>
            </div>

            <div class="insight-card">
                <h3>üìä Volatilidade vs Estabilidade</h3>
                <p>O Bitcoin tende a ter alta volatilidade. A Renda Fixa Brasileira oferece seguran√ßa nominal, mas sofre
                    com a desvaloriza√ß√£o cambial (D√≥lar). A√ß√µes Tech americanas oferecem alto crescimento. Comparar
                    todos ajuda a diversificar.</p>
            </div>
        </section>
        {{end}}
    </div>

    <script>
        function toggleColumn(name, checked) {
            const checkboxes = document.getElementsByName(name);
            for (let i = 0; i < checkboxes.length; i++) {
                checkboxes[i].checked = checked;
            }
        }

        function clearAll() {
            toggleColumn('dca_assets', false);
            toggleColumn('ls_assets', false);
        }
    </script>
</body>

</html>